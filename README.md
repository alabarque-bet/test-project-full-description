# Proyecto hecho con ia a partir de una descripción altamente detallada de los componentes e  implementacion

### Primer prompt
Este es mi requerimiento, este proyecto está recién creado desde spring initializr. Necesito hacer lo siguiente y ten en cuenta que están descriptos usando "nosotros":
Queremos crear un usuario basándonos en datos suministrados por el usuario por un POST por API REST. El usuario tiene como datos Nombre Completo, DNI, email y contraseña. Vamos a persistir estos datos en una base de datos PostgreSQL. La password se debe guardar hasheada por SHA256. El DNI no puede repetirse. El email no puede repetirse. La contraseña debe tener al menos 8 caracteres. El email debe tener formato de email. Hay que validar contra un ente regulador que el DNI sea de una persona viva y mayor a 18 años.

Este es el requerimiento de negocio. Y esta es la solución propuesta por parte del equipo, utilizando Clean Architecture con Java + Spring boot y una base de datos PostgreSQL:
- Definimos la clase entidad de dominio User con las siguientes variables: nombreCompleto, dni, email, password, status.
- Creamos un caso de uso CreateUserImpl que implemente una interfaz CreateUser que reciba un User, setee el status a ‘NEW’ y que llame a un repositorio SaveUserRepository que reciba por parámetro un User.
- Creamos un repositorio de base de datos SaveUserRepositoryImpl que implemente la interfaz SaveUserRepository que transforme User a un objeto de base de datos UserEntity y se encargue de hashear la contraseña. Luego debe llamar al entityManager o a un JPARepository (por ejemplo UserJPARepository) que conozca a UserEntity e insertar el registro.
- Dado que hashear la contraseña puede ser un proceso largo, para no complejizar el repositorio, se puede llevar esa lógica a un método estático helper.
- Creamos el objeto de base de datos UserEntity con el annotation @Entity y reflejamos sus variables a la tabla ‘users’ en PostgreSQL.
- Creamos un Controller para recibir el POST CreateUserController que valide que ninguno de los campos sea nulo o sino lance una excepción. Luego que mapee el json o DTO que recibe a la entidad de dominio User dejando su status como nulo y por último llame al caso de uso CreateUser.
- El DNI no puede repetirse + El email no puede repetirse: Creamos un caso de uso que no retorne nada ValidateUserDoesNotExistImpl que implemente ValidateUserDoesNotExist que llame a un repositorio GetUsersByEmailOrDocumentNumberRepository donde si viene una lista vacía que retorne. Pero si viene al menos un User que lance una excepción.
- Creamos el repositorio GetUsersByEmailOrDocumentNumberRepositoryImpl que implemente GetUsersByEmailOrDocumentNumberRepository, este va a recibir un email y un documento y va a queriar por todos los usuarios que tengan el email UNION ALL todos los usuarios que tengan el documento.
- Hacemos que CreateUserImpl llame a ValidateUserDoesNotExist como primera acción del caso de uso.
- La contraseña debe tener al menos 8 caracteres: Agregamos en CreateUserController una validación para la contraseña que tenga al menos 8 caracteres. Spring boot nos ofrece un annotation para poner sobre la variable del DTO entrante: @Size(min=8, message=”the length of the password must be at least 8 characters”)
- El email debe tener formato de email: Agregamos en CreateUserController una validación para el email que tenga un formato de email correcto. Spring boot nos ofrece un annotation para poner sobre la variable del DTO entrante: @Email(“Email must have a valid email format”)
- Hay que validar contra un ente regulador que el DNI sea de una persona viva y mayor a 18 años: Para esto vamos a asumir que el ente regulador tiene ambos datos en un solo endpoint de API REST para simplificar el texto.
- Creamos un caso de uso ValidateUserIsAliveAndIsAnAdultImpl que implementa ValidateUserIsAliveAndIsAnAdult que llame a un repositorio GetPersonInfoRepository y nos traiga un objeto PersonInfo donde entre sus datos tenga birthDate que sea un LocalDate y isDeceased que sea un booleano. Si isDeceased es true o la diferencia de fechas entre birthDate y hoy es menor a 18 años, se debe lanzar una excepción.
- Creamos el repositorio GetPersonInfoRepositoryImpl que implementa GetPersonInfoRepository llamando por API REST al ente regulador que nos va a devolver un Json que Spring va a mapear a un DTO. De ahí validamos que el DTO tenga el campo birthDate. Luego el repositorio va a crear el objeto PersonInfo con el campo birthDate parseando birthDate a LocalDate y el campo isDeceased tomando fechaFallecido si es vacío o nulo como false y si tiene datos se mappea como true.
- Creamos el objeto PersonInfo con los campos isDeceased booleano y birthDate como LocalDate.
- Hacemos que CreateUserImpl llame a ValidateUserIsAliveAndIsAnAdult.

Aquí terminan los detalles de la implementación. Por favor crea la estructura y desarrollo del proyecto respetando los paquetes de controllers, casos de uso, repositorios, dtos y objetos de infraestructura. Sigue las mejores prácticas de Clean Architecture siempre que se pueda y modulariza el proyecto para tener el maximo desacoplamiento entre partes.